
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://artefactory.github.io/woodtapper/references/mixin/">
      
      
        <link rel="prev" href="../regression_extractors/">
      
      
        <link rel="next" href="../classification_explanation/">
      
      
      <link rel="icon" href="https://raw.githubusercontent.com/artefactory/woodtapper/main/data/logos/logo_woodpecker_compressed.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Base Extractors Mixin - WoodTapper</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#base-rules-extractor-mixin" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="WoodTapper" class="md-header__button md-logo" aria-label="WoodTapper" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/artefactory/woodtapper/main/data/logos/logo_woodpecker_compressed.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WoodTapper
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Base Extractors Mixin
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m3.55 19.09 1.41 1.41 1.8-1.79-1.42-1.42M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6c0-3.32-2.69-6-6-6m8 7h3v-2h-3m-2.76 7.71 1.8 1.79 1.41-1.41-1.79-1.8M20.45 5l-1.41-1.4-1.8 1.79 1.42 1.42M13 1h-2v3h2M6.76 5.39 4.96 3.6 3.55 5l1.79 1.81zM1 13h3v-2H1m12 9h-2v3h2"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 12a10 10 0 0 0 13 9.54 10 10 0 0 1 0-19.08A10 10 0 0 0 2 12"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/artefactory/woodtapper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    WoodTapper
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="WoodTapper" class="md-nav__button md-logo" aria-label="WoodTapper" data-md-component="logo">
      
  <img src="https://raw.githubusercontent.com/artefactory/woodtapper/main/data/logos/logo_woodpecker_compressed.png" alt="logo">

    </a>
    WoodTapper
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/artefactory/woodtapper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    WoodTapper
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../0_tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorials Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../1_tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rules Extractors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2_tutorials_example_exp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example-based explainability
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Rules Extractors
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Rules Extractors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../classification_extractors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classification Extractors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../regression_extractors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Regression Extractors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Base Extractors Mixin
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Base Extractors Mixin
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorClassifierMixin" class="md-nav__link">
    <span class="md-ellipsis">
      RulesExtractorClassifierMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RulesExtractorClassifierMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorClassifierMixin.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorClassifierMixin.predict_proba" class="md-nav__link">
    <span class="md-ellipsis">
      predict_proba
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorMixin" class="md-nav__link">
    <span class="md-ellipsis">
      RulesExtractorMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RulesExtractorMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorMixin.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorRegressorMixin" class="md-nav__link">
    <span class="md-ellipsis">
      RulesExtractorRegressorMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RulesExtractorRegressorMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorRegressorMixin.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Example-based explainability
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Example-based explainability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../classification_explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classification Example Explanation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../regression_explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Regression Example Explanation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mixin_explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base Explanation Mixin
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorClassifierMixin" class="md-nav__link">
    <span class="md-ellipsis">
      RulesExtractorClassifierMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RulesExtractorClassifierMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorClassifierMixin.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorClassifierMixin.predict_proba" class="md-nav__link">
    <span class="md-ellipsis">
      predict_proba
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorMixin" class="md-nav__link">
    <span class="md-ellipsis">
      RulesExtractorMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RulesExtractorMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorMixin.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorRegressorMixin" class="md-nav__link">
    <span class="md-ellipsis">
      RulesExtractorRegressorMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RulesExtractorRegressorMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#woodtapper.extract_rules.base.RulesExtractorRegressorMixin.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/artefactory/woodtapper/edit/main/docs/references/mixin.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="base-rules-extractor-mixin">Base Rules-Extractor Mixin<a class="headerlink" href="#base-rules-extractor-mixin" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="woodtapper.extract_rules.base"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="woodtapper.extract_rules.base.RulesExtractorClassifierMixin" class="doc doc-heading">
            <code>RulesExtractorClassifierMixin</code>


<a href="#woodtapper.extract_rules.base.RulesExtractorClassifierMixin" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="RulesExtractorMixin (woodtapper.extract_rules.base.RulesExtractorMixin)" href="#woodtapper.extract_rules.base.RulesExtractorMixin">RulesExtractorMixin</a></code></p>









              <details class="quote">
                <summary>Source code in <code>woodtapper/extract_rules/base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RulesExtractorClassifierMixin</span><span class="p">(</span><span class="n">RulesExtractorMixin</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_fit_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rules_</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit method for RulesExtractorMixin in classification case.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : array-like, shape (n_samples, n_features)</span>
<span class="sd">            The input samples.</span>
<span class="sd">        y : array-like, shape (n_samples,)</span>
<span class="sd">            The target values (class labels).</span>
<span class="sd">        rules_ : list</span>
<span class="sd">            List of all possible rules extracted from the ensemble of trees.</span>
<span class="sd">        sample_weight : array-like, shape (n_samples,), optional (default=None)</span>
<span class="sd">            Sample weights for each instance.</span>
<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        1. Count unique rules and their frequencies.</span>
<span class="sd">        2. Apply post-treatment to filter redundant rules.</span>
<span class="sd">        3. Calculate probabilities for each rule based on the training data.</span>
<span class="sd">        4. Store the extracted rules and their associated probabilities.</span>
<span class="sd">        5. The method ensures that only relevant and non-redundant rules are retained for the final model.</span>
<span class="sd">        6. It handles both the presence and absence of sample weights during probability calculations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rules_str</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">rules_</span><span class="p">]</span>  <span class="c1"># Trick for np.unique</span>
        <span class="n">rules_</span><span class="p">,</span> <span class="n">rules_freq_</span> <span class="o">=</span> <span class="n">get_top_rules</span><span class="p">(</span><span class="n">rules_str</span><span class="o">=</span><span class="n">rules_str</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p0</span><span class="p">)</span>
        <span class="c1">#### APPLY POST TREATMEANT : remove redundant rules</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">_rules_filtering_stochastic</span><span class="p">(</span>
            <span class="n">rules</span><span class="o">=</span><span class="n">rules_</span><span class="p">,</span>
            <span class="n">probas</span><span class="o">=</span><span class="n">rules_freq_</span><span class="p">,</span>
            <span class="n">max_n_rules</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_n_rules</span><span class="p">,</span>
            <span class="n">n_features_in_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features_in_</span><span class="p">,</span>
            <span class="n">quantiles</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_array_quantile</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
            <span class="n">list_unique_categorical_values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_list_unique_categorical_values</span><span class="p">,</span>
            <span class="n">list_categorical_indexes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_list_categorical_indexes</span><span class="p">,</span>
        <span class="p">)</span>  <span class="c1">## Maximum number of rule to keep=25</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;rules&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules_freq_</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;probas&quot;</span><span class="p">]</span>  <span class="c1"># usefull ?</span>

        <span class="n">list_probas_by_rules</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">list_probas_outside_by_rules</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sample_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),),</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1">## vector of ones</span>
        <span class="n">rules_mask</span> <span class="o">=</span> <span class="n">generate_masks_rules</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)):</span>
            <span class="c1"># for loop for getting all the values in train (X) passing the rules</span>
            <span class="n">final_mask</span> <span class="o">=</span> <span class="n">rules_mask</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
            <span class="n">y_train_rule</span><span class="p">,</span> <span class="n">y_train_outside_rule</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">final_mask</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">final_mask</span><span class="p">]</span>
            <span class="n">sample_weight_rule</span><span class="p">,</span> <span class="n">sample_weight_outside_rule</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">sample_weight</span><span class="p">[</span><span class="n">final_mask</span><span class="p">],</span>
                <span class="n">sample_weight</span><span class="p">[</span><span class="o">~</span><span class="n">final_mask</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="n">list_probas</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">list_probas_outside_rules</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>  <span class="c1"># iteration on each class of the target</span>
                <span class="n">curr_probas</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">sample_weight_rule</span><span class="p">[</span><span class="n">y_train_rule</span> <span class="o">==</span> <span class="n">cl</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                    <span class="o">/</span> <span class="n">sample_weight_rule</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_train_rule</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
                    <span class="k">else</span> <span class="mi">0</span>
                <span class="p">)</span>
                <span class="n">curr_probas_outside_rules</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">sample_weight_outside_rule</span><span class="p">[</span><span class="n">y_train_outside_rule</span> <span class="o">==</span> <span class="n">cl</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                    <span class="o">/</span> <span class="n">sample_weight_outside_rule</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_train_outside_rule</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
                    <span class="k">else</span> <span class="mi">0</span>
                <span class="p">)</span>
                <span class="n">list_probas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">curr_probas</span><span class="p">)</span>  <span class="c1"># len n_classes_</span>
                <span class="n">list_probas_outside_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">curr_probas_outside_rules</span>
                <span class="p">)</span>  <span class="c1"># len n_classes_</span>

            <span class="n">list_probas_by_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">list_probas</span>
            <span class="p">)</span>  <span class="c1"># list of len n_rules of list of len n_classes_</span>
            <span class="n">list_probas_outside_by_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_probas_outside_rules</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_by_rules</span> <span class="o">=</span> <span class="n">list_probas_by_rules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_outside_by_rules</span> <span class="o">=</span> <span class="n">list_probas_outside_by_rules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_target</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        predict_proba method for RulesExtractorMixin. in classification case</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : array-like, shape (n_samples, n_features)</span>
<span class="sd">            The input samples.</span>
<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        y_pred_probas : array-like, shape (n_samples, n_classes)</span>
<span class="sd">            The predicted class probabilities for each sample.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">validate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
        <span class="n">y_pred_probas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">))</span>
        <span class="n">rules_mask</span> <span class="o">=</span> <span class="n">generate_masks_rules</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">indice</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)):</span>
            <span class="n">final_mask</span> <span class="o">=</span> <span class="n">rules_mask</span><span class="p">[:,</span> <span class="n">indice</span><span class="p">]</span>
            <span class="n">y_pred_probas</span><span class="p">[</span><span class="n">final_mask</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_by_rules</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>
            <span class="c1"># add the asociated rule probability</span>
            <span class="n">y_pred_probas</span><span class="p">[</span><span class="o">~</span><span class="n">final_mask</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_outside_by_rules</span><span class="p">[</span>
                <span class="n">indice</span>
            <span class="p">]</span>  <span class="c1"># If the rule is not verified we add the probas of the training samples not verifying the rule.</span>

        <span class="n">y_pred_probas</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_pred_probas</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">y_pred_probas</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict method for RulesExtractorMixin in classification case.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : array-like, shape (n_samples, n_features)</span>
<span class="sd">            The input samples.</span>
<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        y_pred : array-like, shape (n_samples,)</span>
<span class="sd">            The predicted classes for each sample.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">validate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
        <span class="n">y_pred_probas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
        <span class="n">y_pred_numeric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_pred_probas</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred_numeric</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_target</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">):</span>
                <span class="n">y_pred</span><span class="p">[</span><span class="n">y_pred_numeric</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>
            <span class="k">return</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">y_pred_numeric</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="woodtapper.extract_rules.base.RulesExtractorClassifierMixin.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

<a href="#woodtapper.extract_rules.base.RulesExtractorClassifierMixin.predict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Predict method for RulesExtractorMixin in classification case.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code>(<span title="array">array</span> - <span title="like">like</span>, <span title="shape">shape</span>(<span title="n_samples">n_samples</span>, <span title="n_features">n_features</span>))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input samples.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>y_pred</code></td>            <td>
                  <code>(<span title="array">array</span> - <span title="like">like</span>, <span title="shape">shape</span>(<span title="n_samples">n_samples</span>))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The predicted classes for each sample.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>woodtapper/extract_rules/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predict method for RulesExtractorMixin in classification case.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array-like, shape (n_samples, n_features)</span>
<span class="sd">        The input samples.</span>
<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    y_pred : array-like, shape (n_samples,)</span>
<span class="sd">        The predicted classes for each sample.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">validate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="n">y_pred_probas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
    <span class="n">y_pred_numeric</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_pred_probas</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred_numeric</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_target</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_</span><span class="p">):</span>
            <span class="n">y_pred</span><span class="p">[</span><span class="n">y_pred_numeric</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>
        <span class="k">return</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">y_pred_numeric</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="woodtapper.extract_rules.base.RulesExtractorClassifierMixin.predict_proba" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

<a href="#woodtapper.extract_rules.base.RulesExtractorClassifierMixin.predict_proba" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>predict_proba method for RulesExtractorMixin. in classification case</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code>(<span title="array">array</span> - <span title="like">like</span>, <span title="shape">shape</span>(<span title="n_samples">n_samples</span>, <span title="n_features">n_features</span>))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input samples.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>y_pred_probas</code></td>            <td>
                  <code>(<span title="array">array</span> - <span title="like">like</span>, <span title="shape">shape</span>(<span title="n_samples">n_samples</span>, <span title="n_classes">n_classes</span>))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The predicted class probabilities for each sample.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>woodtapper/extract_rules/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    predict_proba method for RulesExtractorMixin. in classification case</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array-like, shape (n_samples, n_features)</span>
<span class="sd">        The input samples.</span>
<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    y_pred_probas : array-like, shape (n_samples, n_classes)</span>
<span class="sd">        The predicted class probabilities for each sample.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">validate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="n">y_pred_probas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">))</span>
    <span class="n">rules_mask</span> <span class="o">=</span> <span class="n">generate_masks_rules</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">indice</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)):</span>
        <span class="n">final_mask</span> <span class="o">=</span> <span class="n">rules_mask</span><span class="p">[:,</span> <span class="n">indice</span><span class="p">]</span>
        <span class="n">y_pred_probas</span><span class="p">[</span><span class="n">final_mask</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_by_rules</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>
        <span class="c1"># add the asociated rule probability</span>
        <span class="n">y_pred_probas</span><span class="p">[</span><span class="o">~</span><span class="n">final_mask</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_outside_by_rules</span><span class="p">[</span>
            <span class="n">indice</span>
        <span class="p">]</span>  <span class="c1"># If the rule is not verified we add the probas of the training samples not verifying the rule.</span>

    <span class="n">y_pred_probas</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_pred_probas</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y_pred_probas</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="woodtapper.extract_rules.base.RulesExtractorMixin" class="doc doc-heading">
            <code>RulesExtractorMixin</code>


<a href="#woodtapper.extract_rules.base.RulesExtractorMixin" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Mixin for rules extraction. Base of all extractors models.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.p0">p0</span></code></td>
            <td>
                  <code>(<span title="float">float</span>, <span title="optional">optional</span>(default=0.01))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequency threshold for rule selection.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.random_state">random_state</span></code></td>
            <td>
                  <code>(<span title="int">int</span>, <span title="optional">optional</span>(default=None))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducibility.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.n_jobs">n_jobs</span></code></td>
            <td>
                  <code>(<span title="int">int</span>, <span title="optional">optional</span>(default=1))</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of parallel jobs for tree construction.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.n_features_in_">n_features_in_</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of features in the input data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.n_classes_">n_classes_</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of classes in the target variable (for classification tasks).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.classes_">classes_</span></code></td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique classes in the target variable (for classification tasks).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.n_rules">n_rules</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of rules extracted from the ensemble.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.rules_">rules_</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of all possible rules extracted from the ensemble.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.rules_freq_">rules_freq_</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of frequencies associated with each rule.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.list_probas_by_rules">list_probas_by_rules</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of probabilities associated with each rule (for classification tasks).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.list_probas_outside_by_rules">list_probas_outside_by_rules</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of probabilities for samples not satisfying each rule (for classification tasks).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.type_target">type_target</span></code></td>
            <td>
                  <code><span title="dtype">dtype</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type of the target variable.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin.ridge">ridge</span></code></td>
            <td>
                  <code>Ridge or RidgeCV instance</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ridge regression model for final prediction (for regression tasks).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin._list_unique_categorical_values">_list_unique_categorical_values</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of unique values for each categorical feature.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin._list_categorical_indexes">_list_categorical_indexes</span></code></td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of indexes of categorical features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="woodtapper.extract_rules.base.RulesExtractorMixin._array_quantile">_array_quantile</span></code></td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of quantiles for continuous features.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>RulesExtractorMixin</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="RulesExtractorMixin (woodtapper.extract_rules.base.RulesExtractorMixin)" href="#woodtapper.extract_rules.base.RulesExtractorMixin">RulesExtractorMixin</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current RulesExtractorMixin instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This mixin provides core functionalities for SIRUS models, including rule extraction from decision trees,
rule filtering, and prediction methods for both classification and regression tasks.
It is designed to be inherited by specific SIRUS model classes.
1. Tree exploration and rule extraction using a custom Node class.
2. Generation of masks for data samples based on extracted rules.
3. Filtering of redundant rules based on linear dependence.
4. Fit and predict methods for classification and regression tasks.
5. Integration with Ridge regression for regression tasks.
6. Handling of both continuous and categorical features.
7. Efficient memory and time management for large datasets.
8. Compatibility with scikit-learn's decision tree structures.
9. Customizable parameters for rule selection and model fitting.
10. Designed for interpretability and simplicity in model predictions.</p>
</details>







              <details class="quote">
                <summary>Source code in <code>woodtapper/extract_rules/base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RulesExtractorMixin</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mixin for rules extraction. Base of all extractors models.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    p0 : float, optional (default=0.01)</span>
<span class="sd">        Frequency threshold for rule selection.</span>
<span class="sd">    random_state : int, optional (default=None)</span>
<span class="sd">        Random seed for reproducibility.</span>
<span class="sd">    n_jobs : int, optional (default=1)</span>
<span class="sd">        Number of parallel jobs for tree construction.</span>
<span class="sd">    n_features_in_ : int</span>
<span class="sd">        Number of features in the input data.</span>
<span class="sd">    n_classes_ : int</span>
<span class="sd">        Number of classes in the target variable (for classification tasks).</span>
<span class="sd">    classes_ : array-like</span>
<span class="sd">        Unique classes in the target variable (for classification tasks).</span>
<span class="sd">    n_rules : int</span>
<span class="sd">        Number of rules extracted from the ensemble.</span>
<span class="sd">    rules_ : list</span>
<span class="sd">        List of all possible rules extracted from the ensemble.</span>
<span class="sd">    rules_freq_ : list</span>
<span class="sd">        List of frequencies associated with each rule.</span>
<span class="sd">    list_probas_by_rules : list</span>
<span class="sd">        List of probabilities associated with each rule (for classification tasks).</span>
<span class="sd">    list_probas_outside_by_rules : list</span>
<span class="sd">        List of probabilities for samples not satisfying each rule (for classification tasks).</span>
<span class="sd">    type_target : dtype</span>
<span class="sd">        Data type of the target variable.</span>
<span class="sd">    ridge : Ridge or RidgeCV instance</span>
<span class="sd">        Ridge regression model for final prediction (for regression tasks).</span>
<span class="sd">    _list_unique_categorical_values : list</span>
<span class="sd">        List of unique values for each categorical feature.</span>
<span class="sd">    _list_categorical_indexes : list</span>
<span class="sd">        List of indexes of categorical features.</span>
<span class="sd">    _array_quantile : array-like</span>
<span class="sd">        Array of quantiles for continuous features.</span>
<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    RulesExtractorMixin: RulesExtractorMixin</span>
<span class="sd">        The current RulesExtractorMixin instance.</span>
<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    This mixin provides core functionalities for SIRUS models, including rule extraction from decision trees,</span>
<span class="sd">    rule filtering, and prediction methods for both classification and regression tasks.</span>
<span class="sd">    It is designed to be inherited by specific SIRUS model classes.</span>
<span class="sd">    1. Tree exploration and rule extraction using a custom Node class.</span>
<span class="sd">    2. Generation of masks for data samples based on extracted rules.</span>
<span class="sd">    3. Filtering of redundant rules based on linear dependence.</span>
<span class="sd">    4. Fit and predict methods for classification and regression tasks.</span>
<span class="sd">    5. Integration with Ridge regression for regression tasks.</span>
<span class="sd">    6. Handling of both continuous and categorical features.</span>
<span class="sd">    7. Efficient memory and time management for large datasets.</span>
<span class="sd">    8. Compatibility with scikit-learn&#39;s decision tree structures.</span>
<span class="sd">    9. Customizable parameters for rule selection and model fitting.</span>
<span class="sd">    10. Designed for interpretability and simplicity in model predictions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#######################################################</span>
    <span class="c1">################ Fit main classifer   #################</span>
    <span class="c1">#######################################################</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_fit_quantile_classifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        fit method for RulesExtractorMixin.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : array-like, shape (n_samples, n_features)</span>
<span class="sd">            The input samples.</span>
<span class="sd">        y : array-like, shape (n_samples,) or (n_samples, n_outputs)</span>

<span class="sd">            The target values (class labels in classification, real numbers in regression).</span>
<span class="sd">        sample_weight : array-like, shape (n_samples,), optional</span>
<span class="sd">            Sample weights. If None, then samples are equally weighted.</span>
<span class="sd">        to_not_binarize_colindexes : list of int, optional (default=None)</span>
<span class="sd">            List of column indices in X that should not be binarized (i.e., treated as categorical).</span>
<span class="sd">        starting_index_one_hot : int, optional (default=None)</span>
<span class="sd">            If provided, all columns from this index onward are treated as one-hot encoded categorical features.</span>
<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        self : object</span>
<span class="sd">            Returns the instance itself.</span>
<span class="sd">        1. Binarize continuous features in X using quantiles, while leaving specified categorical features unchanged.</span>
<span class="sd">        2. Fit the main classifier using the modified dataset.</span>
<span class="sd">        3. Store quantile information and categorical feature details for future use.</span>
<span class="sd">        4. Return the fitted instance.</span>
<span class="sd">        5. If no columns are specified for exclusion from binarization, treat all features as continuous.</span>
<span class="sd">        6. If columns are specified for exclusion, treat those as categorical and binarize only the continuous features.</span>
<span class="sd">        7. Handle one-hot encoded features if a starting index is provided, treating all features from that index onward as categorical.</span>
<span class="sd">        8. Use quantiles to binarize continuous features, ensuring that the binarization respects the distribution of the data.</span>
<span class="sd">        9. Store the quantiles used for binarization, unique values of categorical features, and their indices for future reference.</span>
<span class="sd">        10. Fit the main classifier with the modified dataset, ensuring that it can handle both continuous and categorical features appropriately.</span>
<span class="sd">        11. Ensure that sample weights are appropriately handled during the fitting process.</span>
<span class="sd">        12. Raise an error if no rules are found with the given p0 value, suggesting to decrease it.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">p0</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid value for p0: p0 must be in the range (0, 1].&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_n_rules</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_n_rules must be a positive integer.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantile</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;quantile must be an integer greater than 1.&quot;</span><span class="p">)</span>

        <span class="n">X_bin</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_not_binarize_colindexes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">starting_index_one_hot</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>  <span class="c1"># All variables are continuous</span>
            <span class="n">list_quantile</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">X_bin</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantile</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">array_quantile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">list_quantile</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span>
                    <span class="n">array_quantile</span><span class="p">[:,</span> <span class="n">dim</span><span class="p">],</span> <span class="n">X_bin</span><span class="p">[:,</span> <span class="n">dim</span><span class="p">],</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
                <span class="p">)</span>
                <span class="n">X_bin</span><span class="p">[:,</span> <span class="n">dim</span><span class="p">]</span> <span class="o">=</span> <span class="n">array_quantile</span><span class="p">[</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="p">]</span>
            <span class="n">_list_unique_categorical_values</span> <span class="o">=</span> <span class="p">(</span>
                <span class="kc">None</span>  <span class="c1"># set these to None if all variables are continuous</span>
            <span class="p">)</span>
            <span class="n">_list_categorical_indexes</span> <span class="o">=</span> <span class="p">(</span>
                <span class="kc">None</span>  <span class="c1"># set these to None if all variables are continuous</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">categorical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">starting_index_one_hot</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_list_categorical_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_not_binarize_colindexes</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_not_binarize_colindexes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_list_categorical_indexes</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">starting_index_one_hot</span><span class="p">,</span> <span class="n">X_bin</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_list_categorical_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_not_binarize_colindexes</span> <span class="o">+</span> <span class="p">[</span>
                    <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">starting_index_one_hot</span><span class="p">,</span> <span class="n">X_bin</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="p">]</span>
            <span class="c1">## the last indexes of X must contains the one hot encoded variables !</span>
            <span class="n">categorical</span><span class="p">[</span><span class="n">_list_categorical_indexes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">list_quantile</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">X_bin</span><span class="p">[:,</span> <span class="o">~</span><span class="n">categorical</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantile</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="n">_list_unique_categorical_values</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X_bin</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">_list_categorical_indexes</span>
            <span class="p">]</span>
            <span class="n">array_quantile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">list_quantile</span><span class="p">)</span>

            <span class="n">array_dim_indices_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">array_continuous_dim_indices_samples</span> <span class="o">=</span> <span class="n">array_dim_indices_samples</span><span class="p">[</span>
                <span class="o">~</span><span class="n">categorical</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">ind_dim_quantile</span><span class="p">,</span> <span class="n">cont_dim_samples</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                <span class="n">array_continuous_dim_indices_samples</span>
            <span class="p">):</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span>
                    <span class="n">array_quantile</span><span class="p">[:,</span> <span class="n">ind_dim_quantile</span><span class="p">],</span>
                    <span class="n">X_bin</span><span class="p">[:,</span> <span class="n">cont_dim_samples</span><span class="p">],</span>
                    <span class="n">side</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">X_bin</span><span class="p">[:,</span> <span class="n">cont_dim_samples</span><span class="p">]</span> <span class="o">=</span> <span class="n">array_quantile</span><span class="p">[</span><span class="n">out</span><span class="p">,</span> <span class="n">ind_dim_quantile</span><span class="p">]</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">X_bin</span><span class="p">,</span>
            <span class="n">y</span><span class="p">,</span>
            <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_array_quantile</span> <span class="o">=</span> <span class="n">array_quantile</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_list_unique_categorical_values</span> <span class="o">=</span> <span class="n">_list_unique_categorical_values</span>  <span class="c1"># list of each categorical features containing unique values for each of them</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_list_categorical_indexes</span> <span class="o">=</span> <span class="n">_list_categorical_indexes</span>  <span class="c1"># indices of each categorical features, including the one hot encoded</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit the RulesExtractor model.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : array-like of shape (n_samples, n_features)</span>
<span class="sd">            The training input samples.</span>
<span class="sd">        y : array-like of shape (n_samples,)</span>
<span class="sd">            The target values (class labels) as integers or strings.</span>
<span class="sd">        sample_weight : array-like of shape (n_samples,), default=None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : object</span>
<span class="sd">            Fitted estimator.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">validate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_quantile_classifier</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>
        <span class="n">rules_</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">estimators</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># flattened if needed</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">dtree</span> <span class="ow">in</span> <span class="n">estimators</span><span class="p">:</span>  <span class="c1">## extraction  of all trees rules</span>
            <span class="n">tree</span> <span class="o">=</span> <span class="n">dtree</span><span class="o">.</span><span class="n">tree_</span>
            <span class="n">curr_tree_rules</span> <span class="o">=</span> <span class="n">_extract_single_tree_rules</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">curr_tree_rules</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">curr_tree_rules</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># to avoid empty rules</span>
                <span class="n">rules_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">curr_tree_rules</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_rules</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rules_</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>
        <span class="c1"># Will call the _fit_rules for classifier or regressor (implemented in child class)</span>
        <span class="n">compute_stability_criterion</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="woodtapper.extract_rules.base.RulesExtractorMixin.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#woodtapper.extract_rules.base.RulesExtractorMixin.fit" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Fit the RulesExtractor model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code>array-like of shape (n_samples, n_features)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The training input samples.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y</code>
            </td>
            <td>
                  <code>array-like of shape (n_samples,)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The target values (class labels) as integers or strings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_weight</code>
            </td>
            <td>
                  <code>array-like of shape (n_samples,)</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>self</code></td>            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fitted estimator.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>woodtapper/extract_rules/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fit the RulesExtractor model.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array-like of shape (n_samples, n_features)</span>
<span class="sd">        The training input samples.</span>
<span class="sd">    y : array-like of shape (n_samples,)</span>
<span class="sd">        The target values (class labels) as integers or strings.</span>
<span class="sd">    sample_weight : array-like of shape (n_samples,), default=None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    self : object</span>
<span class="sd">        Fitted estimator.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">validate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fit_quantile_classifier</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>
    <span class="n">rules_</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">estimators</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>  <span class="c1"># flattened if needed</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
        <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">dtree</span> <span class="ow">in</span> <span class="n">estimators</span><span class="p">:</span>  <span class="c1">## extraction  of all trees rules</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">dtree</span><span class="o">.</span><span class="n">tree_</span>
        <span class="n">curr_tree_rules</span> <span class="o">=</span> <span class="n">_extract_single_tree_rules</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">curr_tree_rules</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">curr_tree_rules</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># to avoid empty rules</span>
            <span class="n">rules_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">curr_tree_rules</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fit_rules</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rules_</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>
    <span class="c1"># Will call the _fit_rules for classifier or regressor (implemented in child class)</span>
    <span class="n">compute_stability_criterion</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="woodtapper.extract_rules.base.RulesExtractorRegressorMixin" class="doc doc-heading">
            <code>RulesExtractorRegressorMixin</code>


<a href="#woodtapper.extract_rules.base.RulesExtractorRegressorMixin" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="RulesExtractorMixin (woodtapper.extract_rules.base.RulesExtractorMixin)" href="#woodtapper.extract_rules.base.RulesExtractorMixin">RulesExtractorMixin</a></code></p>









              <details class="quote">
                <summary>Source code in <code>woodtapper/extract_rules/base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RulesExtractorRegressorMixin</span><span class="p">(</span><span class="n">RulesExtractorMixin</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_fit_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rules_</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit method for RulesExtractorMixin in regression case.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : array-like, shape (n_samples, n_features)</span>
<span class="sd">            The input samples.</span>
<span class="sd">        y : array-like, shape (n_samples,)</span>
<span class="sd">            The target values (real numbers).</span>
<span class="sd">        rules_ : list</span>
<span class="sd">            List of all possible rules extracted from the ensemble of trees.</span>
<span class="sd">        sample_weight : array-like, shape (n_samples,), optional (default=None)</span>
<span class="sd">            Sample weights for each instance.</span>
<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        1. Validate input data and initialize parameters.</span>
<span class="sd">        2. Count unique rules and their frequencies.</span>
<span class="sd">        3. Apply post-treatment to filter redundant rules.</span>
<span class="sd">        4. Calculate mean target values for samples satisfying and not satisfying each rule.</span>
<span class="sd">        5. Store the extracted rules and their associated mean target values.</span>
<span class="sd">        6. Fit a Ridge regression model using the rule-based features.</span>
<span class="sd">        7. The method ensures that only relevant and non-redundant rules are retained for the final model.</span>
<span class="sd">        8. It handles both the presence and absence of sample weights during model fitting.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rules_str</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">rules_</span><span class="p">]</span>  <span class="c1"># Trick for np.unique</span>
        <span class="n">rules_</span><span class="p">,</span> <span class="n">rules_freq_</span> <span class="o">=</span> <span class="n">get_top_rules</span><span class="p">(</span><span class="n">rules_str</span><span class="o">=</span><span class="n">rules_str</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p0</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rules_</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;No rule found with the given p0 value. Try to decrease it.&quot;</span>
            <span class="p">)</span>

        <span class="c1">#### APPLY POST TREATMEANT : remove redundant rules</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">_rules_filtering_stochastic</span><span class="p">(</span>
            <span class="n">rules</span><span class="o">=</span><span class="n">rules_</span><span class="p">,</span>
            <span class="n">probas</span><span class="o">=</span><span class="n">rules_freq_</span><span class="p">,</span>
            <span class="n">max_n_rules</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_n_rules</span><span class="p">,</span>
            <span class="n">n_features_in_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features_in_</span><span class="p">,</span>
            <span class="n">quantiles</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_array_quantile</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
            <span class="n">list_unique_categorical_values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_list_unique_categorical_values</span><span class="p">,</span>
            <span class="n">list_categorical_indexes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_list_categorical_indexes</span><span class="p">,</span>
        <span class="p">)</span>  <span class="c1">## Maximum number of rule to keep=25</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;rules&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules_freq_</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;probas&quot;</span><span class="p">]</span>
        <span class="c1"># list_mask_by_rules = []</span>
        <span class="n">list_output_by_rules</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">list_output_outside_by_rules</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">gamma_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)))</span>
        <span class="n">rules_mask</span> <span class="o">=</span> <span class="n">generate_masks_rules</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rule_number</span><span class="p">,</span> <span class="n">current_rules</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">):</span>
            <span class="c1"># for loop for getting all the values in train (X) passing the rules</span>
            <span class="n">final_mask</span> <span class="o">=</span> <span class="n">rules_mask</span><span class="p">[:,</span> <span class="n">rule_number</span><span class="p">]</span>
            <span class="n">output_value</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">final_mask</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="n">final_mask</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">output_outside_value</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">final_mask</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">if</span> <span class="p">(</span><span class="o">~</span><span class="n">final_mask</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="k">else</span> <span class="mi">0</span>

            <span class="n">list_output_by_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output_value</span><span class="p">)</span>
            <span class="n">list_output_outside_by_rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output_outside_value</span><span class="p">)</span>

            <span class="n">gamma_array</span><span class="p">[</span><span class="n">final_mask</span><span class="p">,</span> <span class="n">rule_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_value</span>
            <span class="n">gamma_array</span><span class="p">[</span><span class="o">~</span><span class="n">final_mask</span><span class="p">,</span> <span class="n">rule_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_outside_value</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_by_rules</span> <span class="o">=</span> <span class="n">list_output_by_rules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_outside_by_rules</span> <span class="o">=</span> <span class="n">list_output_outside_by_rules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_target</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span>

        <span class="c1">## final predictor fitting : Ridge regression with positive coefficients</span>
        <span class="n">best_alpha</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">ridge_cv_positive</span><span class="p">(</span>
            <span class="n">gamma_array</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">best_alpha</span><span class="p">,</span>
            <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">gamma_array</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_by_rules_without_coefficients</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_by_rules</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_outside_by_rules_without_coefficients</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_outside_by_rules</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_coefficients_by_rules</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span><span class="o">.</span><span class="n">coef_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coeff_intercept</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span><span class="o">.</span><span class="n">intercept_</span>
        <span class="k">for</span> <span class="n">indice</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)):</span>
            <span class="c1"># Scale the probabilities by the learned coefficients</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span><span class="o">.</span><span class="n">coef_</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span>
                <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span><span class="o">.</span><span class="n">coef_</span><span class="p">[:,</span> <span class="n">indice</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_by_rules</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">coeff</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_by_rules</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_outside_by_rules</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">coeff</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_outside_by_rules</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Predict using the RulesExtractorMixin regressor.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : array-like of shape (n_samples, n_features)</span>
<span class="sd">            The input samples.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        y_pred : ndarray of shape (n_samples,)</span>
<span class="sd">            The predicted values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">validate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
        <span class="n">rules_mask</span> <span class="o">=</span> <span class="n">generate_masks_rules</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)</span>
        <span class="n">gamma_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">indice</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)):</span>
            <span class="n">final_mask</span> <span class="o">=</span> <span class="n">rules_mask</span><span class="p">[:,</span> <span class="n">indice</span><span class="p">]</span>
            <span class="n">gamma_array</span><span class="p">[</span><span class="n">final_mask</span><span class="p">,</span> <span class="n">indice</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_by_rules</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>
            <span class="n">gamma_array</span><span class="p">[</span><span class="o">~</span><span class="n">final_mask</span><span class="p">,</span> <span class="n">indice</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_outside_by_rules</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>
        <span class="c1"># y_pred = self.ridge.predict(gamma_array)</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">gamma_array</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span><span class="o">.</span><span class="n">intercept_</span>

        <span class="k">return</span> <span class="n">y_pred</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="woodtapper.extract_rules.base.RulesExtractorRegressorMixin.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

<a href="#woodtapper.extract_rules.base.RulesExtractorRegressorMixin.predict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Predict using the RulesExtractorMixin regressor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code>array-like of shape (n_samples, n_features)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input samples.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>y_pred</code></td>            <td>
                  <code>ndarray of shape (n_samples,)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The predicted values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>woodtapper/extract_rules/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predict using the RulesExtractorMixin regressor.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    X : array-like of shape (n_samples, n_features)</span>
<span class="sd">        The input samples.</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    y_pred : ndarray of shape (n_samples,)</span>
<span class="sd">        The predicted values.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">validate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="n">rules_mask</span> <span class="o">=</span> <span class="n">generate_masks_rules</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)</span>
    <span class="n">gamma_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">indice</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_</span><span class="p">)):</span>
        <span class="n">final_mask</span> <span class="o">=</span> <span class="n">rules_mask</span><span class="p">[:,</span> <span class="n">indice</span><span class="p">]</span>
        <span class="n">gamma_array</span><span class="p">[</span><span class="n">final_mask</span><span class="p">,</span> <span class="n">indice</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_by_rules</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>
        <span class="n">gamma_array</span><span class="p">[</span><span class="o">~</span><span class="n">final_mask</span><span class="p">,</span> <span class="n">indice</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_probas_outside_by_rules</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>
    <span class="c1"># y_pred = self.ridge.predict(gamma_array)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">gamma_array</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ridge</span><span class="o">.</span><span class="n">intercept_</span>

    <span class="k">return</span> <span class="n">y_pred</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy", "content.math", "content.action.edit"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../javascripts/mathjax-config.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>